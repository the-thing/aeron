#!/usr/bin/env bash

SOURCE_DIR="$(pwd)"

docker build --tag rocky-aeron \
  --build-arg USER_ID="$(id -u)" \
  --build-arg GROUP_ID="$(id -g)" \
  --target essentials-test \
  "${SOURCE_DIR}/cppbuild/rocky"

docker run --rm --shm-size=1G --network host \
  --volume="${SOURCE_DIR}":/opt/aeron \
  --volume="$(realpath ~/.gradle)":/home/athena/.gradle \
  rocky-aeron
